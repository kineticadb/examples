{
  "workbook": {
    "metadata": {},
    "config": {},
    "id": "95262820-6f09-11f0-8425-054f96696726",
    "name": "Real-Time Sensor Alerting System with UDFs ",
    "description": "",
    "user_id": "f52925d0-b1bb-11ef-815c-7d0af97e23f8",
    "warehouse_id": null,
    "is_example": false,
    "is_shared": false,
    "created_at": "2025-03-31T20:05:09.592Z",
    "updated_at": "2025-08-05T16:57:38.743Z",
    "userId": "f52925d0-b1bb-11ef-815c-7d0af97e23f8"
  },
  "worksheets": [
    {
      "config": {
        "chat_messages": []
      },
      "id": "952b0a20-6f09-11f0-8425-054f96696726",
      "name": "Simulating Sensor Data - UDF ",
      "description": "Description for sheet 5",
      "previous_worksheet_id": "95e55970-6f09-11f0-8425-054f96696726",
      "next_worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
      "workbook_id": "95262820-6f09-11f0-8425-054f96696726",
      "created_at": "2025-05-20T16:05:34.613Z",
      "updated_at": "2025-08-05T16:46:10.074Z",
      "workbookId": "95262820-6f09-11f0-8425-054f96696726"
    },
    {
      "config": {
        "chat_messages": []
      },
      "id": "958b0470-6f09-11f0-8425-054f96696726",
      "name": "Introduction",
      "description": "This sheet outlines the table structure for storing sensor data and weather data.\n\n",
      "previous_worksheet_id": null,
      "next_worksheet_id": "95e55970-6f09-11f0-8425-054f96696726",
      "workbook_id": "95262820-6f09-11f0-8425-054f96696726",
      "created_at": "2025-06-09T20:24:36.688Z",
      "updated_at": "2025-08-05T13:02:14.739Z",
      "workbookId": "95262820-6f09-11f0-8425-054f96696726"
    },
    {
      "config": {
        "chat_messages": []
      },
      "id": "959a46b0-6f09-11f0-8425-054f96696726",
      "name": "Simulating Weather Data - UDF",
      "description": "Description for sheet 4",
      "previous_worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
      "next_worksheet_id": "95d26db0-6f09-11f0-8425-054f96696726",
      "workbook_id": "95262820-6f09-11f0-8425-054f96696726",
      "created_at": "2025-06-09T20:34:54.855Z",
      "updated_at": "2025-08-05T16:51:03.050Z",
      "workbookId": "95262820-6f09-11f0-8425-054f96696726"
    },
    {
      "config": {
        "chat_messages": []
      },
      "id": "95bc4da0-6f09-11f0-8425-054f96696726",
      "name": "Adding Webhook Alerts",
      "description": "Description for sheet 5",
      "previous_worksheet_id": "95d26db0-6f09-11f0-8425-054f96696726",
      "next_worksheet_id": null,
      "workbook_id": "95262820-6f09-11f0-8425-054f96696726",
      "created_at": "2025-06-09T20:43:15.313Z",
      "updated_at": "2025-08-05T16:57:38.692Z",
      "workbookId": "95262820-6f09-11f0-8425-054f96696726"
    },
    {
      "config": {
        "chat_messages": []
      },
      "id": "95d26db0-6f09-11f0-8425-054f96696726",
      "name": "Creating a Real Time Sensor Alert Table",
      "description": "",
      "previous_worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
      "next_worksheet_id": "95bc4da0-6f09-11f0-8425-054f96696726",
      "workbook_id": "95262820-6f09-11f0-8425-054f96696726",
      "created_at": "2025-06-09T20:53:05.379Z",
      "updated_at": "2025-08-05T16:55:53.597Z",
      "workbookId": "95262820-6f09-11f0-8425-054f96696726"
    },
    {
      "config": {
        "chat_messages": []
      },
      "id": "95e55970-6f09-11f0-8425-054f96696726",
      "name": "Sensor Data Setup (DDL)",
      "description": "",
      "previous_worksheet_id": "958b0470-6f09-11f0-8425-054f96696726",
      "next_worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
      "workbook_id": "95262820-6f09-11f0-8425-054f96696726",
      "created_at": "2025-06-18T22:45:31.281Z",
      "updated_at": "2025-08-05T16:46:05.970Z",
      "workbookId": "95262820-6f09-11f0-8425-054f96696726"
    }
  ],
  "blockMap": {
    "952b0a20-6f09-11f0-8425-054f96696726": [
      {
        "config": {},
        "id": "952fc510-6f09-11f0-8425-054f96696726",
        "name": "Block 1",
        "description": "Description for Block 1",
        "content": "\"CREATE OR REPLACE PROCEDURE json_extraction.sp_insert_sensor_data\\nBEGIN\\n    EXECUTE FUNCTION simulate_sensor_data (\\n        OUTPUT_TABLE_NAMES => OUTPUT_TABLES('json_extraction.base'),\\n        PARAMS =>  KV_PAIRS(device_id = 'sensor-4390')\\n    );\\n    EXECUTE PROCEDURE json_extraction.wrangle_sensor_data;    \\nEND\\nEXECUTE FOR EVERY 5 MINUTES\\nSTOP AFTER 120 MINUTES;\\n\\n--To start the simulation\\nEXECUTE PROCEDURE json_extraction.sp_insert_sensor_data;\"",
        "previous_block_id": "9544fac0-6f09-11f0-8425-054f96696726",
        "next_block_id": "955d8bd0-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-20T16:05:34.643Z",
        "updated_at": "2025-08-05T16:37:13.550Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95340ad0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"CREATE OR REPLACE FUNCTION simulate_sensor_data\\nRETURNS TABLE (\\n    data json\\n)\\nMODE = 'distributed'\\nRUN_COMMAND = 'python3'\\nRUN_COMMAND_ARGS = 'udfs/simulate_sensor_data.py'\\nFILE PATHS 'kifs://udfs/simulate_sensor_data.py'\\nWITH OPTIONS (SET_ENVIRONMENT = 'sensor_py_environment');\\n\"",
        "previous_block_id": "9560c020-6f09-11f0-8425-054f96696726",
        "next_block_id": "9544fac0-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-20T16:46:23.908Z",
        "updated_at": "2025-08-05T16:37:10.128Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95376630-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"\"",
        "previous_block_id": "93f2ac60-373e-11f0-b677-31559607f41a",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-22T19:02:15.601Z",
        "updated_at": "2025-08-01T18:59:00.132Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "953ac190-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"\"",
        "previous_block_id": "d5ce65f0-3745-11f0-b677-31559607f41a",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-23T15:14:13.554Z",
        "updated_at": "2025-08-01T18:59:00.139Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "953e1cf0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"/*Altering your environment with SQL */\\nCREATE OR REPLACE FUNCTION ENVIRONMENT sensor_py_environment;\\n\\nALTER FUNCTION ENVIRONMENT sensor_py_environment INSTALL PYTHON PACKAGE 'requests';\\n\\n-- Describe the environment to see the packages\\nDESCRIBE FUNCTION ENVIRONMENT sensor_py_environment;\"",
        "previous_block_id": "95663e60-6f09-11f0-8425-054f96696726",
        "next_block_id": "9560c020-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-23T15:16:38.238Z",
        "updated_at": "2025-08-05T16:37:03.373Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95412a30-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Simulating and Inserting Sensor Data into the Base Table Using a Python UDF\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"First, we define a Python User-Defined Function (UDF) called 'simulate_sensor_data.py'  that simulates real-time sensor data and inserts it into the json_extraction.base table. The UDF generates synthetic readings resembling those from a physical device—such as temperature, humidity, voltage, and vibration—and streams them in JSON format.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"To simulate continuous data ingestion, we schedule the UDF to run every 5 minutes over a 2-hour period. \"}]}]",
        "previous_block_id": "95705080-6f09-11f0-8425-054f96696726",
        "next_block_id": "95574a40-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-23T17:37:41.180Z",
        "updated_at": "2025-08-01T18:59:00.152Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "9544fac0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"SCHEDULE UDF EXECUTION VIA STORED PROCEDURE\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"The following stored procedure schedules the periodic insertion of simulated sensor data into the \"},{\"text\":\"json_extraction.base\",\"bold\":true},{\"text\":\" table. It executes every 5 minutes and stops after 2 hours. Additionally, it calls another stored procedure, \"},{\"text\":\"wrangle_sensor_data\",\"bold\":true},{\"text\":\", to process the nested JSON structure into individual sensor readings for each timestamp.\"}]}]",
        "previous_block_id": "95340ad0-6f09-11f0-8425-054f96696726",
        "next_block_id": "952fc510-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-23T17:38:50.709Z",
        "updated_at": "2025-08-05T16:35:52.390Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95487d30-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"\"",
        "previous_block_id": "bd7211a0-3c13-11f0-a23b-cfba7ee6b89e",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-28T22:47:13.544Z",
        "updated_at": "2025-08-01T18:59:00.166Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "954b6360-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"\"",
        "previous_block_id": "e7818410-3c15-11f0-a23b-cfba7ee6b89e",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-28T23:07:52.527Z",
        "updated_at": "2025-08-01T18:59:00.173Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "954e2280-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"\"",
        "previous_block_id": "e7818410-3c15-11f0-a23b-cfba7ee6b89e",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-28T23:29:32.583Z",
        "updated_at": "2025-08-01T18:59:00.180Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95512fc0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"\"",
        "previous_block_id": "e7818410-3c15-11f0-a23b-cfba7ee6b89e",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-05-29T00:13:34.154Z",
        "updated_at": "2025-08-01T18:59:00.187Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95574a40-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Define Your Python UDF Environment\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create a Python environment to be used with your UDF. This ensures that your UDF runs with the required packages.\"}]}]",
        "previous_block_id": "95412a30-6f09-11f0-8425-054f96696726",
        "next_block_id": "95663e60-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-09T20:56:38.723Z",
        "updated_at": "2025-08-01T18:59:00.214Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "955d8bd0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"--Query your raw json base table\\nSELECT * FROM json_extraction.base;\\n\"",
        "previous_block_id": "952fc510-6f09-11f0-8425-054f96696726",
        "next_block_id": "956be3b0-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T00:35:08.569Z",
        "updated_at": "2025-08-05T16:37:17.456Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "9560c020-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"DECLARE YOUR PYTHON UDF FOR SENSOR DATA SIMULATION\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"This function simulates real time sensor readings into a UDF function to populate into the raw base json table, and registers it to the python environment created. \"}]}]",
        "previous_block_id": "953e1cf0-6f09-11f0-8425-054f96696726",
        "next_block_id": "95340ad0-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T04:02:23.836Z",
        "updated_at": "2025-08-01T18:59:00.241Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95663e60-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"DROP FUNCTION simulate_sensor_data;\\nDROP FUNCTION weather_data_enrich;\"",
        "previous_block_id": "95574a40-6f09-11f0-8425-054f96696726",
        "next_block_id": "953e1cf0-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-17T18:36:27.756Z",
        "updated_at": "2025-08-05T16:36:19.752Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "9568d670-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"bold\":true,\"text\":\"USER DEFINED FUNCTIONS (UDFs) in KINETICA\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"User-Defined Functions (UDFs) are custom functions created by users to perform operations that aren't covered by built-in functions within a database management system or programming environment. UDFs can serve to extend the functionality of SQL queries or to encapsulate complex logic into simpler function calls. \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"In this workbook, we use a Python UDF to fetch real-time weather metrics—such as temperature, humidity, wind speed, and pressure—based on the device’s location. This external context is then joined with IoT sensor readings to improve alert accuracy and reduce false positives caused by environmental conditions. By combining the speed and structure of SQL with the flexibility and intelligence of Python, Kinetica UDFs empower a truly adaptive real-time monitoring system.\"}]}]",
        "previous_block_id": null,
        "next_block_id": "95705080-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-19T14:39:28.670Z",
        "updated_at": "2025-08-01T18:59:00.260Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "956be3b0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"--Query your flattened sensor table\\nSELECT * FROM json_extraction.sensor_data;\"",
        "previous_block_id": "955d8bd0-6f09-11f0-8425-054f96696726",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-20T16:09:05.272Z",
        "updated_at": "2025-08-05T16:37:38.820Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95705080-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"bold\":true,\"text\":\"SETUP (MUST COMPLETE BEFORE RUNNING THE REST OF THE CODE)\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Kinetica provides support for User-Defined Function (UDF) creation and management in SQL. Unlike conventional UDFs, Kinetica UDFs are external programs that can be managed via SQL and may be run in distributed fashion across the cluster. This workbook will cover these features.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"1. 'enable_procs': To allow UDFs to be executed, we need to turn the 'enable_procs' option in the configuration parameters for the database. You can access these via GAdmin (http://localhost:8080/gadmin). The login credentials are the same as that for workbench (the tool you are in right now). In GAdmin go to Config -> Advanced. Search for enable_procs (CTRL/CMD + F) and set it to true. Click on Update. The will prompt you to restart the database. Choose this option. Once the database is back up, you can come back here to Workbench and complete the rest of the steps below.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"2. Go to the Files tab (left side explorer) and make a directory on kifs called 'udf' for the purposes of this example.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"3. Download the files 'simulate_sensor_data.py' and 'weather_data_enrich.py' containing the logic to simulate sensor and weather data located here [Github link].\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"3. Upload the file  'simulate_sensor_data.py' and 'weather_data_enrich.py' containing the logic to simulate sensor data above the 'udf' directory in KIFS.\"}]}]",
        "previous_block_id": "9568d670-6f09-11f0-8425-054f96696726",
        "next_block_id": "95412a30-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "952b0a20-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-20T16:38:59.034Z",
        "updated_at": "2025-08-01T18:59:00.273Z",
        "worksheetId": "952b0a20-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      }
    ],
    "958b0470-6f09-11f0-8425-054f96696726": [
      {
        "config": {},
        "id": "958d0040-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Real-Time Sensor Alerting System for Smart Grid Monitoring\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Smart grids rely on real-time sensor data and analytics to manage and monitor energy infrastructure. They measure key parameters such as voltage, current, temperature, and vibration across equipment like transformers and substations. However, these sensor readings can be influenced by external environmental conditions—such as heat, wind, and humidity—potentially leading to false alerts if not properly contextualized.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"This SQL workbook demonstrates how to build a real-time anomaly detection system for industrial equipment using Kinetica’s streaming capabilities. The scenario simulates a network of IoT-enabled sensors deployed across a smart grid. These sensors report real-time metrics including temperature, humidity, voltage, and vibration. Sudden weather changes—such as high winds or drops in atmospheric pressure—can place additional stress on equipment and increase the risk of failure.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"To mitigate such risks, this workbook shows how enriching device readings with external environmental metrics, we improve the accuracy of alerts and support smarter grid operations. Using Kinetica’s \"},{\"text\":\"User-Defined Functions (UDFs)\",\"bold\":true},{\"text\":\", materialized views, and ASOF (as-of) joins, the system enriches sensor streams with local weather metrics every five minutes. It then automatically detects anomalies—such as overheating, voltage spikes, or correlated vibration during high wind events, and pushes alerts to external systems for rapid response.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"DATASETS USED:\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"1. IoT Sensor Data\",\"bold\":true},{\"text\":\": Simulated smart grid metrics such as temperature, humidity, voltage, and vibration collected from IoT-enabled field devices.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"2. Weather Sensor Data\",\"bold\":true},{\"text\":\": Real-time environmental data fetched from the OpenWeather API every five minutes, including temperature, humidity, wind speed, and atmospheric pressure.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Together, these datasets enable a robust, data-driven monitoring system capable of distinguishing between equipment failure and weather-induced anomalies.\"}]}]",
        "previous_block_id": "958f7140-6f09-11f0-8425-054f96696726",
        "next_block_id": "95945340-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "958b0470-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-09T20:52:29.736Z",
        "updated_at": "2025-08-01T18:59:00.355Z",
        "worksheetId": "958b0470-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "958f7140-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "{}",
        "previous_block_id": null,
        "next_block_id": "958d0040-6f09-11f0-8425-054f96696726",
        "block_type_id": "016d9471-1913-4c85-894a-101e82909fd3",
        "worksheet_id": "958b0470-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-19T15:30:01.266Z",
        "updated_at": "2025-08-01T18:59:00.366Z",
        "worksheetId": "958b0470-6f09-11f0-8425-054f96696726",
        "blockTypeId": "016d9471-1913-4c85-894a-101e82909fd3"
      },
      {
        "config": {
          "isBlockVisible": true
        },
        "id": "95945340-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"This Workbook Is Divided Into Three Main Sections:\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"1. Data Setup\",\"bold\":true},{\"text\":\": You’ll simulate sensor readings in JSON format, extract and flatten this data into a structured table, and then pivot it for easier metric analysis. Simultaneously, you’ll use a Python UDF to fetch live weather data for mapped device locations. These two datasets—sensor and weather—are then prepped for real-time enrichment and anomaly detection.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"2. Weather Enrichment and Anomaly Detection\",\"bold\":true},{\"text\":\": Using a Python UDF and ASOF joins, you’ll match each sensor reading with the most recent weather observation to generate enriched event records.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"3. Real-Time Alerting:\",\"bold\":true},{\"text\":\"  Materialized views continuously monitor the enriched sensor records. When predefined thresholds are exceeded—such as high voltage during extreme heat—alerts are triggered and delivered in real time via a webhook stream or Slack integration.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"How to Run the Demo\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"All necessary steps and instructions are provided within the workbook.\"}]}]",
        "previous_block_id": "958d0040-6f09-11f0-8425-054f96696726",
        "next_block_id": null,
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "958b0470-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-23T17:33:30.935Z",
        "updated_at": "2025-08-01T18:59:00.373Z",
        "worksheetId": "958b0470-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      }
    ],
    "959a46b0-6f09-11f0-8425-054f96696726": [
      {
        "config": {},
        "id": "959cb7b0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"CREATE OR REPLACE FUNCTION weather_data_enrich\\nRETURNS TABLE (\\n    last_updated TIMESTAMP,\\n    latitude DOUBLE,\\n    longitude DOUBLE,\\n    weather_temp_c DOUBLE,\\n    weather_humidity INT,\\n    weather_pressure INT,\\n    wind_speed DOUBLE\\n)\\nMODE = 'distributed'\\nRUN_COMMAND = 'python3'\\nRUN_COMMAND_ARGS = 'udfs/weather_data_enrich.py'\\nFILE PATHS 'kifs://udfs/weather_data_enrich.py'\\nWITH OPTIONS (SET_ENVIRONMENT = 'sensor_py_environment');\"",
        "previous_block_id": "959f4fc0-6f09-11f0-8425-054f96696726",
        "next_block_id": "95a458d0-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-09T20:38:34.768Z",
        "updated_at": "2025-08-05T16:37:58.148Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "959f4fc0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"LOAD WEATHER DATA USING UDF\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Next, we register the weather_data_enrich.py script, which fetches real-time weather metrics from the OpenWeather API. This Python UDF retrieves weather data—such as temperature, humidity, wind speed, and pressure—based on each device's geolocation.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"The enriched weather data is then used to enhance the sensor records, providing environmental context that can help explain anomalies or variations in sensor performance.\"}]}]",
        "previous_block_id": "95b17830-6f09-11f0-8425-054f96696726",
        "next_block_id": "959cb7b0-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-09T20:38:57.428Z",
        "updated_at": "2025-08-01T18:59:00.549Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95a1c0c0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"CREATE OR REPLACE PROCEDURE json_extraction.sp_stream_weather_to_lookup\\nBEGIN\\n    EXECUTE FUNCTION weather_data_enrich (\\n        OUTPUT_TABLE_NAMES => OUTPUT_TABLES('json_extraction.weather_lookup'),\\n        PARAMS => KV_PAIRS(latitude = '42.36', longitude = '-71.05')\\n    );\\nEND\\nEXECUTE FOR EVERY 5 MINUTES\\nSTOP AFTER 2 HOUR;\\n\\n--To manually start the streaming process:\\nEXECUTE PROCEDURE json_extraction.sp_stream_weather_to_lookup;\\n\"",
        "previous_block_id": "95a458d0-6f09-11f0-8425-054f96696726",
        "next_block_id": "95a6a2c0-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-09T20:39:47.446Z",
        "updated_at": "2025-08-05T16:38:19.281Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95a458d0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Schedule Weather UDF Execution Using Stored Procedure\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"To simulate a continuously updating stream of weather data, we create a stored procedure that runs the weather enrichment UDF every 5 minutes for a duration of 2 hours. This ensures the weather_lookup table remains up to date with the latest weather conditions based on device locations.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"The procedure executes the Python UDF weather_data_enrich.py, which fetches real-time metrics from the OpenWeather API and inserts them into the weather_lookup table. The longitude and latitude are set to Boston by default, but they can be changed in the parameters.\"}]}]",
        "previous_block_id": "959cb7b0-6f09-11f0-8425-054f96696726",
        "next_block_id": "95a1c0c0-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-09T20:39:52.438Z",
        "updated_at": "2025-08-01T18:59:00.562Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {
          "pageSize": 5
        },
        "id": "95a6a2c0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"SELECT * FROM json_extraction.weather_lookup;\"",
        "previous_block_id": "95a1c0c0-6f09-11f0-8425-054f96696726",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T00:37:03.636Z",
        "updated_at": "2025-08-05T16:38:22.031Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95a93ad0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"CREATE WEATHER LOOK UP TABLE\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"This table stores real-time weather data for each device, based on location and timestamp. The data will later be joined with sensor data for enrichment and anomaly detection.\"}]}]",
        "previous_block_id": "95af0730-6f09-11f0-8425-054f96696726",
        "next_block_id": "95abf9f0-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T04:17:43.750Z",
        "updated_at": "2025-08-01T18:59:00.576Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95abf9f0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"CREATE OR REPLACE TABLE json_extraction.weather_lookup (\\n    last_updated TIMESTAMP,\\n    latitude DOUBLE,\\n    longitude DOUBLE,\\n    weather_temp_c DOUBLE,\\n    weather_humidity INT,\\n    weather_pressure INT,\\n    wind_speed DOUBLE\\n);\"",
        "previous_block_id": "95a93ad0-6f09-11f0-8425-054f96696726",
        "next_block_id": "95b17830-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T04:18:35.932Z",
        "updated_at": "2025-08-05T16:37:51.412Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95af0730-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Enrich IoT Sensor Data with Weather Data Using Python UDF\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"To better understand sensor behavior in real-world conditions, we enrich the sensor data with local weather information. Environmental factors—such as high temperatures, humidity, or strong winds—can impact how sensors perform. For example, a sudden spike in a machine’s temperature sensor might not indicate a malfunction if it's a particularly hot and humid day.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"By adding weather context, we can:\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- Identify external causes for sensor anomalies (e.g., overheating due to high ambient temperatures).\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- Improve anomaly detection by distinguishing between internal faults and external environmental changes.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- Gain deeper insights into how devices perform under different weather conditions.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"We use a Python UDF to perform this enrichment. Here's how it works:\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- The UDF queries the OpenWeather API using the sensor's device ID and location.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- It retrieves real-time weather metrics such as temperature, humidity, wind speed, and pressure.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- The fetched weather data is inserted into the weather_lookup table.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"This UDF is designed to run periodically to simulate real-time enrichment, ensuring that each sensor reading is paired with up-to-date environmental data.\"}]}]",
        "previous_block_id": null,
        "next_block_id": "95a93ad0-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T04:23:04.346Z",
        "updated_at": "2025-08-01T18:59:00.589Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95b17830-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"RETRIEVE API KEY FROM OPENWEATHER API\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"To retrieve an API key from OpenWeather, start by visiting \"},{\"text\":\"https://home.openweathermap.org\",\"bold\":true},{\"text\":\" and creating an account. For this project, we will be using the Current Weather Data API, which provides real-time weather data based on geographic coordinates (latitude and longitude).\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Once registered and signed in, navigate to your API key dashboard at \"},{\"text\":\"https://home.openweathermap.org/api_keys\",\"bold\":true},{\"text\":\". Create a new one by clicking “Create key,” assigning it a name, and saving it. This API key is required to authenticate requests to OpenWeather’s services, including current weather, forecasts, and historical data. \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"In our Python UDF, weather_data_enrich.py (uploaded to the /udfs directory), we dynamically insert the latitude, longitude, and API key to retrieve weather metrics such as temperature, humidity, wind speed, and pressure.\"}]}]",
        "previous_block_id": "95abf9f0-6f09-11f0-8425-054f96696726",
        "next_block_id": "959f4fc0-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "959a46b0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-19T15:43:29.096Z",
        "updated_at": "2025-08-01T18:59:00.595Z",
        "worksheetId": "959a46b0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      }
    ],
    "95bc4da0-6f09-11f0-8425-054f96696726": [
      {
        "config": {},
        "id": "95be4970-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"🚨 Generate Webhook Alerts from Detected Sensor Anomalies\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Once anomalies have been detected and recorded in the mv_sensor_alerts materialized view, the next step is to send these alerts to external systems so that teams can take immediate action.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"A common use case is to send real-time alerts to a Slack channel, email system, or incident management tool—allowing operations or engineering teams to respond quickly.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"In Kinetica, you can use a stream to publish changes from a table (like mv_sensor_alerts) to a target destination. This target could be a webhook, a Kafka topic or any other compatible external service. \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Try It Yourself with Webhook.site\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"For testing purposes, the easiest way to try out webhook alerts is by using Webhook.site:\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- Visit https://webhook.site.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- A unique URL will be generated for you automatically.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- Use this URL as the target endpoint for your stream configuration.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Once the stream is active, head back to the Webhook.site page to observe incoming HTTP requests in real time.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"This lets you visually confirm that alerts are being triggered and sent correctly—making it a great way to test before integrating with messaging systems like Slack.\"}]}]",
        "previous_block_id": null,
        "next_block_id": "95c0e180-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95bc4da0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T04:31:33.023Z",
        "updated_at": "2025-08-05T14:55:34.043Z",
        "worksheetId": "95bc4da0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95c0e180-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"CREATE STREAM ki_home.webhook_alerts\\nON TABLE json_extraction.mv_sensor_alerts\\nREFRESH ON CHANGE\\nWITH OPTIONS \\n(\\n    DESTINATION = 'ADD WEBHOOK URL HERE'\\n);\"",
        "previous_block_id": "95be4970-6f09-11f0-8425-054f96696726",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95bc4da0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-25T19:45:50.236Z",
        "updated_at": "2025-08-05T14:54:48.804Z",
        "worksheetId": "95bc4da0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      }
    ],
    "95d26db0-6f09-11f0-8425-054f96696726": [
      {
        "config": {},
        "id": "95d4b7a0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Sensor and weather data often arrive at different times, so directly joining them using exact timestamps can result in mismatches. To accurately associate each sensor reading with the most relevant weather conditions, we use an ASOF (As-Of) join.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"An ASOF join matches each sensor record with the closest preceding weather record within a defined time range. In our case, we use:\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- INTERVAL '-5' MINUTES as the search precision, meaning the join looks backward up to 5 minutes.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- INTERVAL '10' MINUTES as the maximum search range, allowing a total matching window of 15 minutes (from 5 minutes before to 10 minutes after the sensor timestamp).\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"- The MIN keyword selects the earliest matching weather record within that time window.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"This approach ensures that each sensor reading is paired with the most temporally relevant weather data, even when the two streams are not perfectly synchronized.\"}]}]",
        "previous_block_id": "95dbbc80-6f09-11f0-8425-054f96696726",
        "next_block_id": "95de7ba0-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95d26db0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T01:23:04.910Z",
        "updated_at": "2025-08-01T19:36:59.454Z",
        "worksheetId": "95d26db0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95d70190-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"\"",
        "previous_block_id": "587ed7b0-45aa-11f0-94ff-1d1317672a6f",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95d26db0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T03:29:39.779Z",
        "updated_at": "2025-08-01T18:59:00.846Z",
        "worksheetId": "95d26db0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95dbbc80-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\" Create a Real-Time Sensor Alert Table Joining Weather and Sensor Data\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"To detect anomalies in real-time, we combine sensor readings with contextual weather data. Both data streams—sensor metrics and weather metrics—are refreshed every 5 minutes during a 2-hour simulation window.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"By joining these two data sources using an ASOF (as-of) join on timestamp and device location, we can detect patterns and trigger alerts for abnormal behavior, such as device temperature significantly exceeding ambient temperature. \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"After joining the sensor and weather metrics, to identify abnormal behavior using thresholds:\"}]},{\"type\":\"paragraph\",\"children\":[{\"bold\":true,\"text\":\"-\"},{\"text\":\" \"},{\"text\":\"Temperature Alert: \",\"bold\":true},{\"text\":\"Triggered when the device's internal temperature deviates by more than 1% from the weather temperature. Note that is a purposefully low threshold for demo purposes (so that the alert getes triggered a lot). \"}]}]",
        "previous_block_id": null,
        "next_block_id": "95d4b7a0-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95d26db0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-10T04:28:26.504Z",
        "updated_at": "2025-08-05T14:59:29.855Z",
        "worksheetId": "95d26db0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95de7ba0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"CREATE OR REPLACE MATERIALIZED VIEW json_extraction.mv_sensor_alerts \\nREFRESH ON CHANGE AS\\n(\\n    WITH joined AS (\\n        SELECT \\n            s.device_id,\\n            s.last_updated AS sensor_updated_at,\\n            w.last_updated AS weather_updated_at,\\n            s.temperature AS sensor_temp_f,\\n            ROUND(w.weather_temp_c * 9.0/5.0 + 32, 2) AS weather_temp_f, --convert to fahrenheit\\n            ROUND\\n            (\\n              s.temperature \\n              - (w.weather_temp_c * 9.0/5.0 + 32),\\n              2\\n            ) AS delta_temp_f\\n        FROM json_extraction.sensor_data s\\n        JOIN json_extraction.weather_lookup w \\n            ON ASOF(\\n                s.last_updated, \\n                w.last_updated, \\n                INTERVAL '-5' MINUTES, \\n                INTERVAL '10' MINUTES, \\n                MIN\\n            ) -- ASOF JOIN\\n    )\\n    SELECT \\n        *, \\n        CASE \\n            WHEN ABS(delta_temp_f) / NULLIF(weather_temp_f, 0) > 0.1\\n            THEN CONCAT('⚠️ TEMPERATURE ALERT: ΔT is greater than 0.1 at', NOW())\\n            ELSE NULL\\n        END AS alertNotification\\n    FROM joined\\n);\\n\"",
        "previous_block_id": "95d4b7a0-6f09-11f0-8425-054f96696726",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95d26db0-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-18T22:25:20.605Z",
        "updated_at": "2025-08-05T16:44:49.523Z",
        "worksheetId": "95d26db0-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      }
    ],
    "95e55970-6f09-11f0-8425-054f96696726": [
      {
        "config": {},
        "id": "95e77c50-6f09-11f0-8425-054f96696726",
        "name": "Block 1",
        "description": "Description for Block 1",
        "content": "\"DROP SCHEMA IF EXISTS json_extraction CASCADE;\\n\\nCREATE SCHEMA IF NOT EXISTS json_extraction;\\n\\nCREATE OR REPLACE TABLE json_extraction.base (\\n    data json\\n);\"",
        "previous_block_id": "95ea1460-6f09-11f0-8425-054f96696726",
        "next_block_id": "95f251c0-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95e55970-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-18T22:45:31.325Z",
        "updated_at": "2025-08-05T16:35:04.699Z",
        "worksheetId": "95e55970-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95ea1460-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"SETUP THE BASE TABLE \",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Below we will create a schema and a base table with a single column 'data' to store incoming raw sensor readings in JSON format. We will use UDFs to simulate raw sensor data into the base table. \"}]}]",
        "previous_block_id": null,
        "next_block_id": "95e77c50-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95e55970-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-18T22:46:41.284Z",
        "updated_at": "2025-08-01T18:59:00.997Z",
        "worksheetId": "95e55970-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95ec8560-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"CREATE OR REPLACE PROCEDURE json_extraction.wrangle_sensor_data\\nBEGIN\\n  INSERT INTO json_extraction.sensor_data\\n  WITH readings_extracted AS (\\n    SELECT \\n        json_value(data, '$.device_id') AS device_id,\\n        json_value(data, '$.last_updated') AS last_updated,\\n        json(json_query(data, '$.readings')) AS readings_array\\n    FROM json_extraction.base\\n  ),\\n  readings_exploded AS (\\n    SELECT \\n        device_id, \\n        last_updated, \\n        reading.reading\\n    FROM readings_extracted, unnest_json_array(readings_array) reading\\n  ),\\n  readings_structured AS (\\n      SELECT\\n        device_id,\\n        last_updated,\\n        json_value(reading, '$.scenario') AS scenario,\\n        json_query(reading, '$.status') AS status,\\n        json(json_query(reading, '$.metrics')) AS metrics_array\\n    FROM readings_exploded\\n  ),\\n  readings_flat AS (\\n      SELECT \\n        device_id,\\n        last_updated,\\n        scenario,\\n        json_value(status, '$.read_error_message') AS read_error_message,\\n        json_value(status, '$.read_error_type') AS read_error_type,\\n        json_value(status, '$.read_status') AS read_status,\\n        json_value(metric, '$.value') AS value,\\n        json_value(metric, '$.type') AS type\\n    FROM readings_structured, unnest_json_array(metrics_array) metric\\n  )\\nSELECT\\n    device_id,\\n    last_updated,\\n    scenario,\\n    temperature,\\n    humidity,\\n    voltage,\\n    vibration\\nFROM readings_flat\\nPIVOT (\\n    MAX(value) \\n    FOR type IN ('temperature' AS temperature, \\n                 'humidity' AS humidity, \\n                 'voltage' AS voltage, \\n                 'vibration' AS vibration)\\n);\\nEND;\\n\"",
        "previous_block_id": "95f537f0-6f09-11f0-8425-054f96696726",
        "next_block_id": null,
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95e55970-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-18T22:47:22.180Z",
        "updated_at": "2025-08-05T16:35:05.215Z",
        "worksheetId": "95e55970-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95f251c0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"CREATE FLATTENED SENSOR DATA TABLE SCHEMA\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"The following SQL creates the json_extraction.sensor_flat table, which stores flattened sensor data extracted from nested JSON structures. Flattening the data simplifies querying and analysis by transforming complex, hierarchical sensor readings into a straightforward tabular format.\"}]}]",
        "previous_block_id": "95e77c50-6f09-11f0-8425-054f96696726",
        "next_block_id": "6bc77cf0-7219-11f0-b27d-9ff6d418ea21",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95e55970-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-20T16:34:35.610Z",
        "updated_at": "2025-08-05T16:31:50.337Z",
        "worksheetId": "95e55970-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "95f537f0-6f09-11f0-8425-054f96696726",
        "name": "Block",
        "description": "Description for Block",
        "content": "[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create Store Procedure to Flatten Nested Sensor Data \",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"This stored procedure processes raw sensor data stored in the json_extraction.base table by flattening nested JSON structures and inserting the results into the sensor_flat table. It enables easier querying and analysis of individual sensor readings.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"How it works:\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"1. Extract Top-Level Fields: Selects deviceId, lastUpdated, and the nested readings JSON array from the base table.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"2. Explode Readings Array: Unnests the readings array so each reading becomes a separate row.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"3. Structure Each Reading: Extracts scenario, status, and another nested metrics array from each reading.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"4. Extract Metrics: Unnests the metrics array and extracts detailed fields like: ReadErrorMessage, ReadErrorType, ReadStatus, value (numeric sensor reading), type (sensor metric type, e.g., temperature)\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"5. Pivot the table: Pivot into a wide format—consolidating all metrics into a single row per device and timestamp. \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"This procedure automates transforming complex, nested JSON sensor data into a simple tabular format for downstream processing and analysis.\"}]}]",
        "previous_block_id": "6bc77cf0-7219-11f0-b27d-9ff6d418ea21",
        "next_block_id": "95ec8560-6f09-11f0-8425-054f96696726",
        "block_type_id": "a9949a1a-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95e55970-6f09-11f0-8425-054f96696726",
        "created_at": "2025-06-20T16:36:51.578Z",
        "updated_at": "2025-08-05T16:32:47.564Z",
        "worksheetId": "95e55970-6f09-11f0-8425-054f96696726",
        "blockTypeId": "a9949a1a-14e3-11eb-adc1-0242ac120002"
      },
      {
        "config": {},
        "id": "6bc77cf0-7219-11f0-b27d-9ff6d418ea21",
        "name": "Block",
        "description": "Description for Block",
        "content": "\"CREATE OR REPLACE TABLE json_extraction.sensor_data (\\n    device_id varchar(64) NOT NULL,\\n    last_updated datetime NOT NULL,\\n    scenario varchar(64, dict) NOT NULL,\\n    temperature real NOT NULL,\\n    humidity real NOT NULL,\\n    voltage real NOT NULL,\\n    vibration real NOT NULL\\n)\"",
        "previous_block_id": "95f251c0-6f09-11f0-8425-054f96696726",
        "next_block_id": "95f537f0-6f09-11f0-8425-054f96696726",
        "block_type_id": "84b9233c-14e3-11eb-adc1-0242ac120002",
        "worksheet_id": "95e55970-6f09-11f0-8425-054f96696726",
        "created_at": "2025-08-05T16:29:55.647Z",
        "updated_at": "2025-08-05T16:35:05.552Z",
        "worksheetId": "95e55970-6f09-11f0-8425-054f96696726",
        "blockTypeId": "84b9233c-14e3-11eb-adc1-0242ac120002"
      }
    ]
  },
  "vizMap": {
    "952fc510-6f09-11f0-8425-054f96696726": [],
    "95340ad0-6f09-11f0-8425-054f96696726": [],
    "95376630-6f09-11f0-8425-054f96696726": [],
    "953ac190-6f09-11f0-8425-054f96696726": [],
    "953e1cf0-6f09-11f0-8425-054f96696726": [],
    "95412a30-6f09-11f0-8425-054f96696726": [],
    "9544fac0-6f09-11f0-8425-054f96696726": [],
    "95487d30-6f09-11f0-8425-054f96696726": [],
    "954b6360-6f09-11f0-8425-054f96696726": [],
    "954e2280-6f09-11f0-8425-054f96696726": [],
    "95512fc0-6f09-11f0-8425-054f96696726": [],
    "95574a40-6f09-11f0-8425-054f96696726": [],
    "955d8bd0-6f09-11f0-8425-054f96696726": [],
    "9560c020-6f09-11f0-8425-054f96696726": [],
    "95663e60-6f09-11f0-8425-054f96696726": [],
    "9568d670-6f09-11f0-8425-054f96696726": [],
    "956be3b0-6f09-11f0-8425-054f96696726": [],
    "95705080-6f09-11f0-8425-054f96696726": [],
    "958d0040-6f09-11f0-8425-054f96696726": [],
    "958f7140-6f09-11f0-8425-054f96696726": [
      {
        "config": {
          "image_url": "https://github.com/kineticadb/examples/blob/master/_assets/images/sensor_weather_v2.png?raw=true",
          "height": "50%",
          "width": "50%",
          "alignment": "center",
          "title": "Real-time Alerting With Kinetica"
        },
        "id": "9591e240-6f09-11f0-8425-054f96696726",
        "name": "Image Visualization",
        "description": "Description for image visualization",
        "block_id": "958f7140-6f09-11f0-8425-054f96696726",
        "visualization_type_id": "61ec39b0-3295-4354-b92c-831fec4dacb3",
        "created_at": "2025-06-19T15:30:01.325Z",
        "updated_at": "2025-08-01T18:59:00.324Z",
        "blockId": "958f7140-6f09-11f0-8425-054f96696726",
        "visualizationTypeId": "61ec39b0-3295-4354-b92c-831fec4dacb3"
      }
    ],
    "95945340-6f09-11f0-8425-054f96696726": [],
    "959cb7b0-6f09-11f0-8425-054f96696726": [],
    "959f4fc0-6f09-11f0-8425-054f96696726": [],
    "95a1c0c0-6f09-11f0-8425-054f96696726": [],
    "95a458d0-6f09-11f0-8425-054f96696726": [],
    "95a6a2c0-6f09-11f0-8425-054f96696726": [],
    "95a93ad0-6f09-11f0-8425-054f96696726": [],
    "95abf9f0-6f09-11f0-8425-054f96696726": [],
    "95af0730-6f09-11f0-8425-054f96696726": [],
    "95b17830-6f09-11f0-8425-054f96696726": [],
    "95be4970-6f09-11f0-8425-054f96696726": [],
    "95c0e180-6f09-11f0-8425-054f96696726": [],
    "95d4b7a0-6f09-11f0-8425-054f96696726": [],
    "95d70190-6f09-11f0-8425-054f96696726": [],
    "95dbbc80-6f09-11f0-8425-054f96696726": [],
    "95de7ba0-6f09-11f0-8425-054f96696726": [],
    "95e77c50-6f09-11f0-8425-054f96696726": [],
    "95ea1460-6f09-11f0-8425-054f96696726": [],
    "95ec8560-6f09-11f0-8425-054f96696726": [],
    "95f251c0-6f09-11f0-8425-054f96696726": [],
    "95f537f0-6f09-11f0-8425-054f96696726": [],
    "6bc77cf0-7219-11f0-b27d-9ff6d418ea21": []
  }
}